#!/usr/bin/env bash

# Editor
export EDITOR='hx'

# Colorful prompt with git branch
parse_git_branch() {
    git branch 2>/dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/ (\1)/'
}

# Colors
RED='\[\033[0;31m\]'
GREEN='\[\033[0;32m\]'
YELLOW='\[\033[0;33m\]'
BLUE='\[\033[0;34m\]'
PURPLE='\[\033[0;35m\]'
CYAN='\[\033[0;36m\]'
WHITE='\[\033[0;37m\]'
RESET='\[\033[0m\]'

export PS1="${GREEN}\u${RESET}@${CYAN}\h${RESET}:${BLUE}\w${YELLOW}\$(parse_git_branch)${RESET}\$ "

# Common paths
export PATH="$HOME/bin:$HOME/binaries:$PATH"
export PATH="$HOME/.cargo/bin:$PATH"
export PATH="$HOME/.local/bin:$PATH"

# Docker
export DOCKER_CLI_EXPERIMENTAL=enabled

# OS-specific
case "$(uname -s)" in
    Darwin)
        # macOS
        export PATH="/opt/homebrew/bin:$PATH"
        [ -x /opt/homebrew/bin/brew ] && eval "$(/opt/homebrew/bin/brew shellenv)"
        export PATH="/opt/homebrew/opt/gnu-sed/libexec/gnubin:$PATH"
        export BASH_SILENCE_DEPRECATION_WARNING=1
        export PATH="$HOME/.bun/bin:$PATH"
        ;;
    MINGW*|MSYS*|CYGWIN*)
        # Windows (Git Bash / MSYS2)
        export PATH="/c/msys64/ucrt64/bin:$PATH"
        export PATH="/c/Program Files/nodejs:$PATH"
        export PATH="$APPDATA/npm:$PATH"
        ;;
    Linux)
        # Linux - CUDA if nvidia
        if command -v nvidia-smi &> /dev/null; then
            export PATH="/usr/local/cuda/bin:$PATH"
            export LD_LIBRARY_PATH="/usr/local/cuda/lib64:$LD_LIBRARY_PATH"
        fi
        ;;
esac
