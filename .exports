#!/usr/bin/env bash

# Make vim the default editor.
export EDITOR='vim';

# Prompt style fg;txtformat(0, 1, 4);bg
export PS1='\u@\h:\w$ '

# k8s
export KUBECONFIG=$HOME/.kube/kubeconfig.yml

# go
export PATH=$PATH:/usr/local/go/bin
export PATH=$PATH:$HOME/go/bin

# Binaries
export PATH=$PATH:$HOME/binaries

# Rust
export PATH=$PATH:$HOME/.cargo/bin

# Arkade
export PATH=$PATH:$HOME/.arkade/bin/

# Docker (buildx)
export DOCKER_CLI_EXPERIMENTAL=enabled

export PATH=$PATH:$HOME/binaries/flutter/bin
export PATH=$PATH:/usr/lib/dart/bin:$HOME/binaries/flutter/.pub-cache/bin
export ANDROID_HOME=$HOME/Android/Sdk

# MacOS
if [[ "$OSTYPE" == "darwin"* ]]; then
    export PATH="/opt/homebrew/bin:$PATH"
    eval "$(/opt/homebrew/bin/brew shellenv)"
    export NVM_DIR="$HOME/.nvm"
    [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
    [ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion

    export ANDROID_HOME=$HOME/Library/Android/sdk/
    export PATH=$HOME/Library/Android/sdk/platform-tools:$PATH

    export PATH=/usr/local/share/dotnet:$PATH
    export PATH=/Applications/Android\ Studio.app/Contents/jre/jdk/Contents/Home/bin:$PATH
    # ruby
    export PATH=/opt/homebrew/opt/ruby/bin:$PATH
    export PATH=/opt/homebrew/lib/ruby/gems/3.0.0/bin:$PATH

    export PATH="/opt/homebrew/opt/python@3.8/bin:$PATH"
    export LDFLAGS="-L/opt/homebrew/opt/python@3.8/lib"
    export PKG_CONFIG_PATH="/opt/homebrew/opt/python@3.8/lib/pkgconfig"

fi

# Some distro requires that the absolute path is given when invoking lspci
# e.g. /sbin/lspci if the user is not root.
gpu=$(lspci || "no gpu" | grep -i '.* vga .* nvidia .*')

shopt -s nocasematch

if [[ $gpu == *' nvidia '* ]]; then
    printf 'Nvidia GPU is present:  %s\n' "$gpu"
    export PATH="/usr/local/cuda-11.5/bin${PATH:+:${PATH}}"
    export LD_LIBRARY_PATH="/usr/local/cuda-11.5/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}"
else
    printf 'Nvidia GPU is not present: %s\n' "$gpu"
fi
